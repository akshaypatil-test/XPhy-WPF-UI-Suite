<UserControl x:Class="x_phy_wpf_ui.Controls.BottomBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="60" d:DesignWidth="940">
    <UserControl.Resources>
        <SolidColorBrush x:Key="CardBackgroundBrush" Color="{DynamicResource Color.Card}"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="{DynamicResource Color.TextSecondary}"/>
        <SolidColorBrush x:Key="AccentBrush" Color="{DynamicResource Color.Primary}"/>
        <SolidColorBrush x:Key="TealColor" Color="{DynamicResource Color.Secondary}"/>
        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    <Border Background="{StaticResource CardBackgroundBrush}" 
            CornerRadius="16"
            Padding="0"
            BorderThickness="0">
        <Grid Margin="24,14,24,14">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Left Section: Status, Remaining Days, Subscribe Button -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                <!-- Status -->
                <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                    <TextBlock Text="Status: " 
                               FontSize="13" 
                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="StatusText" 
                               Text="Trial" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="{StaticResource TealColor}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Remain: X Days -->
                <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                    <TextBlock Text="Remain: " 
                               FontSize="13" 
                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="RemainDaysText" 
                               Text="30" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="{StaticResource TealColor}" VerticalAlignment="Center"/>
                    <TextBlock Text=" Days" 
                               FontSize="13" 
                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Attempts (Trial only) -->
                <StackPanel x:Name="AttemptsPanel" Orientation="Horizontal" Margin="0,0,20,0" Visibility="Visible">
                    <TextBlock Text="Attempts: " 
                               FontSize="13" 
                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="AttemptsText" 
                               Text="30" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="{StaticResource TealColor}" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Subscribe Now Button -->
                <Button x:Name="SubscribeButton"
                        Content="Subscribe Now"
                        Foreground="White"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Padding="20,10"
                        MinWidth="130"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="SubscribeButton_Click"
                        VerticalAlignment="Center"
                        Visibility="Visible" Height="37" Width="148">
                    <Button.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#990C0B0C"/>
                            <GradientStop Color="#999F0C6D" Offset="0.502"/>
                        </LinearGradientBrush>
                    </Button.Background>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                               CornerRadius="20"
                                               Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#F0458A"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </StackPanel>

            <!-- Right Section: Support and Logout -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right">
                <Button Content="â„¹ï¸ Support" 
                        Style="{StaticResource NavButtonStyle}"
                        Click="SupportButton_Click"
                        Padding="12,8"
                        Margin="0,0,12,0"/>
                <Grid>
                    <Button x:Name="LogoutButton"
                            Content="ðŸšª Log out" 
                            Style="{StaticResource NavButtonStyle}"
                            Click="LogoutButton_Click"
                            Padding="12,8"
                            Margin="0,0,0,0"/>
                    <!-- Loading Spinner -->
                    <Ellipse x:Name="LogoutLoader"
                             Width="20"
                             Height="20"
                             Stroke="{StaticResource AccentBrush}"
                             StrokeThickness="3"
                             StrokeDashArray="5,5"
                             RenderTransformOrigin="0.5,0.5"
                             Visibility="Collapsed"
                             HorizontalAlignment="Right"
                             VerticalAlignment="Center"
                             Margin="0,0,30,0">
                        <Ellipse.RenderTransform>
                            <RotateTransform x:Name="LoaderRotateTransform"/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                </Grid>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
