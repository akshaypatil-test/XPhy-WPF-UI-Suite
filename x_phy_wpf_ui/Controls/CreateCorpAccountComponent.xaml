<UserControl x:Class="x_phy_wpf_ui.Controls.CreateCorpAccountComponent"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:primitives="clr-namespace:System.Windows.Controls.Primitives;assembly=PresentationFramework"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1000">
    <UserControl.Resources>
        <Style TargetType="ScrollBar">
            <Setter Property="Width" Value="0"/>
            <Setter Property="MinWidth" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid>
                            <Border Background="{TemplateBinding Background}" CornerRadius="2"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ModernTextBoxInnerStyleFullWidth" TargetType="TextBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            <Setter Property="CaretBrush" Value="{DynamicResource Brush.White}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Margin="0"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ModernPasswordBoxInnerStyle" TargetType="PasswordBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            <Setter Property="CaretBrush" Value="{DynamicResource Brush.White}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,8,40,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="PasswordBox">
                        <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Margin="0"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ModernTextBoxInnerStyle" TargetType="TextBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            <Setter Property="CaretBrush" Value="{DynamicResource Brush.White}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,8,40,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Margin="0"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="LaunchButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource Brush.Primary}"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.White}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="24,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Brush.PrimaryHover}"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="{DynamicResource Brush.Disabled}"/>
                    <Setter Property="Foreground" Value="{DynamicResource Brush.TextSecondary}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Back: dark background, teal/cyan border, white text (matches screenshot) -->
        <Style x:Key="BackButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource Brush.Card}"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Secondary}"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="24,12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Brush.SurfaceHover}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Section header: magenta/pink to match active step (e.g. "1 Personal") -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.Primary}"/>
        </Style>
        <Style x:Key="FieldLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.TextSecondary}"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>
    </UserControl.Resources>

    <Grid Background="Transparent" Margin="24,0,24,12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title (tighter to top navbar) -->
        <StackPanel Grid.Row="0" HorizontalAlignment="Center" Margin="0,0,0,6">
            <TextBlock Text="Register Corporate User" FontSize="24" FontWeight="Bold" Foreground="{DynamicResource Brush.TextPrimary}" TextAlignment="Center"/>
            <TextBlock Text="Create A New Corporate User For Your Organization" FontSize="14" Foreground="{DynamicResource Brush.TextSecondary}" TextAlignment="Center" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Step indicator: numbers in circles, step label in cyan when active (updated from code) -->
        <StackPanel x:Name="StepIndicatorPanel" Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Border x:Name="Step1Circle" Width="28" Height="28" CornerRadius="14" BorderThickness="1" BorderBrush="{DynamicResource Brush.Secondary}" Background="Transparent" Margin="0,0,8,0">
                    <TextBlock x:Name="Step1Number" Text="1" FontSize="13" FontWeight="SemiBold" Foreground="{DynamicResource Brush.Secondary}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <TextBlock x:Name="Step1Label" Text="Personal" FontSize="13" FontWeight="SemiBold" Foreground="{DynamicResource Brush.Secondary}" VerticalAlignment="Center"/>
            </StackPanel>
            <TextBlock Text=" –----- " FontSize="12" Foreground="{DynamicResource Brush.TextSecondary}" VerticalAlignment="Center" Margin="0,0,4,0"/>
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Border x:Name="Step2Circle" Width="28" Height="28" CornerRadius="14" BorderThickness="1" BorderBrush="{DynamicResource Brush.TextSecondary}" Background="Transparent" Margin="0,0,8,0">
                    <TextBlock x:Name="Step2Number" Text="2" FontSize="13" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextSecondary}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <TextBlock x:Name="Step2Label" Text="Organization" FontSize="13" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextSecondary}" VerticalAlignment="Center"/>
            </StackPanel>
            <TextBlock Text=" –------ " FontSize="12" Foreground="{DynamicResource Brush.TextSecondary}" VerticalAlignment="Center" Margin="0,0,4,0"/>
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Border x:Name="Step3Circle" Width="28" Height="28" CornerRadius="14" BorderThickness="1" BorderBrush="{DynamicResource Brush.TextSecondary}" Background="Transparent" Margin="0,0,8,0">
                    <TextBlock x:Name="Step3Number" Text="3" FontSize="13" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextSecondary}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <TextBlock x:Name="Step3Label" Text="Policy" FontSize="13" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextSecondary}" VerticalAlignment="Center"/>
            </StackPanel>
        </StackPanel>

        <TextBlock x:Name="ErrorMessageText" Grid.Row="2" Text="" FontSize="12" Foreground="{DynamicResource Brush.Error}" TextAlignment="Center" TextWrapping="Wrap" Margin="0,0,0,8" Visibility="Collapsed"/>

        <!-- Step content: scrollable so Password/Confirm Password are never cut off -->
        <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Padding="0,0,0,0">
        <Grid ClipToBounds="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackPanel x:Name="Step1Panel" Grid.Row="0" Width="360" HorizontalAlignment="Center" VerticalAlignment="Top">
                <!-- Personal: no duplicate heading (step indicator shows it) -->
                <StackPanel Margin="0,0,0,0">
                        <TextBlock Text="First Name" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="FirstNameFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="FirstNameTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="FirstNameTextBox_TextChanged" LostFocus="FirstNameTextBox_LostFocus"/>
                                <TextBlock x:Name="FirstNamePlaceholder" Text="Enter your first name" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="FirstNameErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Last Name" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="LastNameFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="LastNameTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="LastNameTextBox_TextChanged" LostFocus="LastNameTextBox_LostFocus"/>
                                <TextBlock x:Name="LastNamePlaceholder" Text="Enter your last name" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="LastNameErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Username" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="EmailFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="EmailTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="EmailTextBox_TextChanged" LostFocus="EmailTextBox_LostFocus"/>
                                <TextBlock x:Name="EmailPlaceholder" Text="Enter your email address" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="EmailErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <Grid Margin="0,0,0,6">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="Password" Style="{StaticResource FieldLabelStyle}" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                <Button x:Name="PasswordInfoButton" Width="18" Height="18" Padding="0" Margin="0" VerticalAlignment="Center" Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="Password requirements" Click="PasswordInfoButton_Click">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" BorderBrush="{DynamicResource Brush.TextSecondary}" BorderThickness="1" CornerRadius="9" Width="18" Height="18" ClipToBounds="True">
                                                <TextBlock Text="i" FontSize="11" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextSecondary}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                            <Popup x:Name="PasswordRequirementsPopup" PlacementTarget="{Binding ElementName=PasswordInfoButton}" Placement="Right" StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                                <Border Background="{DynamicResource Brush.Card}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="8" Padding="14,12" Margin="8,0,0,0" MinWidth="220">
                                    <StackPanel>
                                        <TextBlock Text="Password requirements" FontSize="12" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextPrimary}" Margin="0,0,0,10"/>
                                        <TextBlock Text="• Minimum 8 characters" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                        <TextBlock Text="• One uppercase letter" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                        <TextBlock Text="• One lowercase letter" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                        <TextBlock Text="• One number" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                        <TextBlock Text="• One special character (@$!%*?&amp;)" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Popup>
                        </Grid>
                        <Border x:Name="PasswordFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <PasswordBox x:Name="PasswordBox" Style="{StaticResource ModernPasswordBoxInnerStyle}" PasswordChanged="PasswordBox_PasswordChanged" LostFocus="PasswordBox_LostFocus"/>
                                    <TextBox x:Name="PasswordRevealTextBox" Style="{StaticResource ModernTextBoxInnerStyle}" Visibility="Collapsed" TextChanged="PasswordRevealTextBox_TextChanged" LostFocus="PasswordBox_LostFocus"/>
                                    <TextBlock x:Name="PasswordPlaceholder" Text="Create a password" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8,40,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                                </Grid>
                                <Button x:Name="PasswordEyeButton" Grid.Column="1" Width="36" Height="32" VerticalAlignment="Center" Margin="0,0,6,0" Background="Transparent" BorderThickness="0" Cursor="Hand" Click="PasswordEyeButton_Click">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" Padding="4">
                                                <Viewbox Width="16" Height="16">
                                                    <Path Fill="{DynamicResource Brush.TextSecondary}" Data="M12,4.5 C7,4.5 2.73,7.61 1,12 2.73,16.39 7,19.5 12,19.5 17,19.5 21.27,16.39 23,12 21.27,7.61 17,4.5 12,4.5 Z M12,17 C9.24,17 7,14.76 7,12 7,9.24 9.24,7 12,7 14.76,7 17,9.24 17,12 17,14.76 14.76,17 12,17 Z"/>
                                                </Viewbox>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="PasswordErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Confirm Password" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="ConfirmPasswordFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <PasswordBox x:Name="ConfirmPasswordBox" Style="{StaticResource ModernPasswordBoxInnerStyle}" PasswordChanged="ConfirmPasswordBox_PasswordChanged" LostFocus="ConfirmPasswordBox_LostFocus"/>
                                    <TextBox x:Name="ConfirmPasswordRevealTextBox" Style="{StaticResource ModernTextBoxInnerStyle}" Visibility="Collapsed" TextChanged="ConfirmPasswordRevealTextBox_TextChanged" LostFocus="ConfirmPasswordBox_LostFocus"/>
                                    <TextBlock x:Name="ConfirmPasswordPlaceholder" Text="Re-enter your password" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8,40,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                                </Grid>
                                <Button x:Name="ConfirmPasswordEyeButton" Grid.Column="1" Width="36" Height="32" VerticalAlignment="Center" Margin="0,0,6,0" Background="Transparent" BorderThickness="0" Cursor="Hand" Click="ConfirmPasswordEyeButton_Click">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" Padding="4">
                                                <Viewbox Width="16" Height="16">
                                                    <Path Fill="{DynamicResource Brush.TextSecondary}" Data="M12,4.5 C7,4.5 2.73,7.61 1,12 2.73,16.39 7,19.5 12,19.5 17,19.5 21.27,16.39 23,12 21.27,7.61 17,4.5 12,4.5 Z M12,17 C9.24,17 7,14.76 7,12 7,9.24 9.24,7 12,7 14.76,7 17,9.24 17,12 17,14.76 14.76,17 12,17 Z"/>
                                                </Viewbox>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="ConfirmPasswordErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,0" Visibility="Collapsed" TextWrapping="Wrap"/>
                </StackPanel>
            </StackPanel>

            <!-- 2 Organization (no card background) -->
            <StackPanel x:Name="Step2Panel" Grid.Row="1" Width="360" HorizontalAlignment="Center" VerticalAlignment="Top" Visibility="Collapsed">
                <StackPanel>
                        <TextBlock Text="Organisation Name" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="OrganizationNameFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,14">
                            <Grid>
                                <TextBox x:Name="OrganizationNameTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="OrganizationNameTextBox_TextChanged" LostFocus="OrganizationNameTextBox_LostFocus"/>
                                <TextBlock x:Name="OrganizationNamePlaceholder" Text="Enter your organization name" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>

                        <TextBlock Text="Contact Person" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="ContactPersonNameFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,14">
                            <Grid>
                                <TextBox x:Name="ContactPersonNameTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="ContactPersonNameTextBox_TextChanged" LostFocus="ContactPersonNameTextBox_LostFocus"/>
                                <TextBlock x:Name="ContactPersonNamePlaceholder" Text="Enter your contact person name" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>

                        <TextBlock Text="Country Code" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="CountryCodeFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="CountryCodeTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="CountryCodeTextBox_TextChanged" LostFocus="CountryCodeTextBox_LostFocus"/>
                                <TextBlock x:Name="CountryCodePlaceholder" Text="Enter country code" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="CountryCodeErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Contact no" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="ContactNumberFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="ContactNumberTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="ContactNumberTextBox_TextChanged" LostFocus="ContactNumberTextBox_LostFocus"/>
                                <TextBlock x:Name="ContactNumberPlaceholder" Text="Enter your contact no." Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="ContactNumberErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Purchase Order Number" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="OrderNumberFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,0">
                            <Grid>
                                <TextBox x:Name="OrderNumberTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="OrderNumberTextBox_TextChanged" LostFocus="OrderNumberTextBox_LostFocus"/>
                                <TextBlock x:Name="OrderNumberPlaceholder" Text="Enter your purchase order no." Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                </StackPanel>
            </StackPanel>

            <!-- 3 Policy (no card background) -->
            <StackPanel x:Name="Step3Panel" Grid.Row="2" Width="360" HorizontalAlignment="Center" VerticalAlignment="Top" Visibility="Collapsed">
                <StackPanel>
                        <TextBlock Text="Policy Number" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="PolicyNumberFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="PolicyNumberTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="PolicyNumberTextBox_TextChanged" LostFocus="PolicyNumberTextBox_LostFocus"/>
                                <TextBlock x:Name="PolicyNumberPlaceholder" Text="Enter your policy number" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="PolicyNumberErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Total Machine count" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="MaxDevicesFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <Grid>
                                <TextBox x:Name="MaxDevicesTextBox" Style="{StaticResource ModernTextBoxInnerStyleFullWidth}" TextChanged="MaxDevicesTextBox_TextChanged" LostFocus="MaxDevicesTextBox_LostFocus"/>
                                <TextBlock x:Name="MaxDevicesPlaceholder" Text="Enter your total machine count" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="13" Margin="12,8" VerticalAlignment="Center" IsHitTestVisible="False"/>
                            </Grid>
                        </Border>
                        <TextBlock x:Name="MaxDevicesErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,10" Visibility="Collapsed" TextWrapping="Wrap"/>

                        <TextBlock Text="Activation Date" Style="{StaticResource FieldLabelStyle}"/>
                        <Border x:Name="ActivationDateFieldBorder" Background="{DynamicResource Brush.InputBackground}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="6" MinHeight="40" Margin="0,0,0,4">
                            <DatePicker x:Name="ActivationDatePicker"
                                        Background="Transparent"
                                        Foreground="{DynamicResource Brush.TextPrimary}"
                                        BorderThickness="0"
                                        Padding="12,8"
                                        FontSize="14"
                                        SelectedDateChanged="ActivationDatePicker_SelectedDateChanged"
                                        LostFocus="ActivationDatePicker_LostFocus"
                                        VerticalAlignment="Center">
                                <DatePicker.Resources>
                                    <Style TargetType="{x:Type primitives:DatePickerTextBox}">
                                        <Setter Property="Background" Value="{DynamicResource Brush.InputBackground}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                                        <Setter Property="CaretBrush" Value="{DynamicResource Brush.TextPrimary}"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Padding" Value="0"/>
                                    </Style>
                                </DatePicker.Resources>
                            </DatePicker>
                        </Border>
                        <TextBlock x:Name="ActivationDateErrorText" Text="" FontSize="10" Foreground="{DynamicResource Brush.Error}" Margin="2,0,0,0" Visibility="Collapsed" TextWrapping="Wrap"/>
                </StackPanel>
            </StackPanel>
        </Grid>
        </ScrollViewer>

        <!-- Buttons: same 360px width as input area, height 40 to match input boxes; spacing matches gap between form fields -->
        <Grid Grid.Row="4" Panel.ZIndex="10" Width="360" HorizontalAlignment="Center" Margin="0,12,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="8"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button x:Name="BackButton" Grid.Column="0" Content="Back" Style="{StaticResource BackButtonStyle}" Click="Back_Click" HorizontalAlignment="Stretch" Height="40" Padding="16,0" Visibility="Collapsed"/>
            <Grid Grid.Column="2">
                <Button x:Name="NextButton" Content="Next" Style="{StaticResource LaunchButtonStyle}" Click="Next_Click" HorizontalAlignment="Stretch" Height="40" Padding="16,0" IsEnabled="False"/>
                <Button x:Name="CreateButton" Content="Create Account" Style="{StaticResource LaunchButtonStyle}" Click="Create_Click" IsEnabled="False" HorizontalAlignment="Stretch" Height="40" Padding="16,0" Visibility="Collapsed"/>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
