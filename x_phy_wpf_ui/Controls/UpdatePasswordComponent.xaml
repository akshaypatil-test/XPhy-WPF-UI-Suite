<UserControl x:Class="x_phy_wpf_ui.Controls.UpdatePasswordComponent"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1000">
    <UserControl.Resources>
        <!-- No local resources needed - using centralized design system -->
    </UserControl.Resources>

    <Grid Background="Transparent">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Left" Width="400" Margin="50,40,50,50">

                <TextBlock Text="Update Your Password"
                           Style="{StaticResource Text.Title}"
                           TextAlignment="Center" Margin="{StaticResource Margin.FieldGroup}"/>
                <TextBlock Text="For Security Reasons, You Must Change The Default Password Upon First Login."
                           Style="{StaticResource Text.BodySecondary}"
                           TextAlignment="Center" TextWrapping="Wrap"
                           Margin="{StaticResource Margin.ContentBottom}"/>

                <TextBlock x:Name="ErrorMessageText" Text=""
                           Style="{StaticResource Text.ErrorMessage}"
                           TextAlignment="Center" TextWrapping="Wrap" Margin="{StaticResource Margin.SectionBottom}" Visibility="Collapsed"/>

                <!-- Current Password -->
                <TextBlock Text="Current Password" Style="{StaticResource Label.Field}"/>
                <Border x:Name="CurrentPasswordFieldBorder"
                        Style="{StaticResource Border.InputContainer}"
                        Margin="{StaticResource Margin.FieldBottom}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <PasswordBox x:Name="CurrentPasswordBox"
                                         Style="{StaticResource PasswordBox.Inner}"
                                         PasswordChanged="CurrentPasswordBox_PasswordChanged" LostFocus="CurrentPasswordBox_LostFocus"/>
                            <TextBox x:Name="CurrentPasswordReveal"
                                     Style="{StaticResource TextBox.InnerWithIcon}"
                                     Visibility="Collapsed" TextChanged="CurrentPasswordReveal_TextChanged" LostFocus="CurrentPasswordBox_LostFocus"/>
                            <TextBlock x:Name="CurrentPasswordPlaceholder" Text="Enter your current password"
                                       Style="{StaticResource TextBlock.Placeholder}"
                                       Margin="16,8,40,8"/>
                        </Grid>
                        <Button x:Name="CurrentPasswordEye" Grid.Column="1" Width="40" Height="36"
                                Style="{StaticResource Button.Icon}"
                                VerticalAlignment="Center" Margin="0,0,8,0"
                                Click="CurrentPasswordEye_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" Padding="6">
                                        <Viewbox Width="20" Height="20">
                                            <Grid Width="24" Height="24">
                                                <Path Stroke="{DynamicResource Brush.TextSecondary}" StrokeThickness="1.25" Fill="Transparent" Data="M 12,5.5 C 7,5.5 2.5,9 1,12 2.5,15 7,18.5 12,18.5 17,18.5 21.5,15 23,12 21.5,9 17,5.5 12,5.5 Z"/>
                                                <Ellipse Width="8" Height="8" Stroke="{DynamicResource Brush.TextSecondary}" StrokeThickness="1.25" Fill="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Viewbox>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </Border>
                <TextBlock x:Name="CurrentPasswordErrorText" Text="" Style="{StaticResource Text.Error}"
                           Margin="4,0,0,0" Visibility="Collapsed" TextWrapping="Wrap"/>

                <!-- New Password (with info icon + popup) -->
                <Grid Margin="{StaticResource Margin.SectionBottom}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="New Password" Style="{StaticResource Text.CaptionBold}" VerticalAlignment="Center"/>
                        <Button x:Name="NewPasswordInfoButton" Width="18" Height="18"
                                Margin="6,0,0,0" Style="{StaticResource Button.Icon}"
                                Click="NewPasswordInfoButton_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" BorderBrush="{DynamicResource Brush.TextSecondary}" BorderThickness="1" CornerRadius="9" Width="18" Height="18" ClipToBounds="True">
                                        <TextBlock Text="i" FontSize="11" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextSecondary}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                    <Popup x:Name="PasswordRequirementsPopup" PlacementTarget="{Binding ElementName=NewPasswordInfoButton}" Placement="Right" StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                        <Border Background="{DynamicResource Brush.Card}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" CornerRadius="8" Padding="14,12" Margin="8,0,0,0" MinWidth="220">
                            <StackPanel>
                                <TextBlock Text="Password requirements" FontSize="12" FontWeight="SemiBold" Foreground="{DynamicResource Brush.TextPrimary}" Margin="0,0,0,10"/>
                                <TextBlock Text="• Minimum 8 characters" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                <TextBlock Text="• One uppercase letter" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                <TextBlock Text="• One lowercase letter" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                <TextBlock Text="• One number" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,4"/>
                                <TextBlock Text="• One special character (@$!%*?&amp;)" FontSize="11" Foreground="#4ADE80" Margin="0,0,0,0"/>
                            </StackPanel>
                        </Border>
                    </Popup>
                </Grid>
                <Border x:Name="NewPasswordFieldBorder"
                        Style="{StaticResource Border.InputContainer}"
                        Margin="{StaticResource Margin.FieldBottom}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <PasswordBox x:Name="NewPasswordBox"
                                         Style="{StaticResource PasswordBox.Inner}"
                                         PasswordChanged="NewPasswordBox_PasswordChanged" LostFocus="NewPasswordBox_LostFocus"/>
                            <TextBox x:Name="NewPasswordReveal"
                                     Style="{StaticResource TextBox.InnerWithIcon}"
                                     Visibility="Collapsed" TextChanged="NewPasswordReveal_TextChanged" LostFocus="NewPasswordBox_LostFocus"/>
                            <TextBlock x:Name="NewPasswordPlaceholder" Text="Create new password"
                                       Style="{StaticResource TextBlock.Placeholder}"
                                       Margin="16,8,40,8"/>
                        </Grid>
                        <Button x:Name="NewPasswordEye" Grid.Column="1" Width="40" Height="36"
                                Style="{StaticResource Button.Icon}"
                                VerticalAlignment="Center" Margin="0,0,8,0"
                                Click="NewPasswordEye_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" Padding="6">
                                        <Viewbox Width="20" Height="20">
                                            <Grid Width="24" Height="24">
                                                <Path Stroke="{DynamicResource Brush.TextSecondary}" StrokeThickness="1.25" Fill="Transparent" Data="M 12,5.5 C 7,5.5 2.5,9 1,12 2.5,15 7,18.5 12,18.5 17,18.5 21.5,15 23,12 21.5,9 17,5.5 12,5.5 Z"/>
                                                <Ellipse Width="8" Height="8" Stroke="{DynamicResource Brush.TextSecondary}" StrokeThickness="1.25" Fill="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Viewbox>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </Border>
                <TextBlock x:Name="NewPasswordErrorText" Text="" Style="{StaticResource Text.Error}"
                           Margin="4,0,0,0" Visibility="Collapsed" TextWrapping="Wrap"/>

                <!-- Confirm Password -->
                <TextBlock Text="Confirm Password" Style="{StaticResource Label.Field}"
                           Margin="{StaticResource Margin.SectionBottom}"/>
                <Border x:Name="ConfirmPasswordFieldBorder"
                        Style="{StaticResource Border.InputContainer}"
                        Margin="{StaticResource Margin.FieldBottom}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <PasswordBox x:Name="ConfirmPasswordBox"
                                         Style="{StaticResource PasswordBox.Inner}"
                                         PasswordChanged="ConfirmPasswordBox_PasswordChanged" LostFocus="ConfirmPasswordBox_LostFocus"/>
                            <TextBox x:Name="ConfirmPasswordReveal"
                                     Style="{StaticResource TextBox.InnerWithIcon}"
                                     Visibility="Collapsed" TextChanged="ConfirmPasswordReveal_TextChanged" LostFocus="ConfirmPasswordBox_LostFocus"/>
                            <TextBlock x:Name="ConfirmPasswordPlaceholder" Text="Confirm your password"
                                       Style="{StaticResource TextBlock.Placeholder}"
                                       Margin="16,8,40,8"/>
                        </Grid>
                        <Button x:Name="ConfirmPasswordEye" Grid.Column="1" Width="40" Height="36"
                                Style="{StaticResource Button.Icon}"
                                VerticalAlignment="Center" Margin="0,0,8,0"
                                Click="ConfirmPasswordEye_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" Padding="6">
                                        <Viewbox Width="20" Height="20">
                                            <Grid Width="24" Height="24">
                                                <Path Stroke="{DynamicResource Brush.TextSecondary}" StrokeThickness="1.25" Fill="Transparent" Data="M 12,5.5 C 7,5.5 2.5,9 1,12 2.5,15 7,18.5 12,18.5 17,18.5 21.5,15 23,12 21.5,9 17,5.5 12,5.5 Z"/>
                                                <Ellipse Width="8" Height="8" Stroke="{DynamicResource Brush.TextSecondary}" StrokeThickness="1.25" Fill="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Viewbox>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </Border>
                <TextBlock x:Name="ConfirmPasswordErrorText" Text="" Style="{StaticResource Text.Error}"
                           Margin="4,0,0,0" Visibility="Collapsed" TextWrapping="Wrap"/>

                <Button x:Name="UpdatePasswordButton"
                        Content="Update Password"
                        Style="{StaticResource Button.Primary}"
                        Click="UpdatePassword_Click"
                        IsEnabled="False"
                        Margin="{StaticResource Spacing.XL}"
                        HorizontalAlignment="Stretch"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
